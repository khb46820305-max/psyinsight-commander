# 이메일 발송 설정 가이드

## 📧 이메일 발송 기능 개요

수집된 뉴스와 논문의 헤드라인을 지정한 이메일로 자동 발송합니다.

---

## 🔧 Gmail SMTP 설정 방법

### 1. Gmail 앱 비밀번호 생성

**왜 필요한가?**
- Gmail의 2단계 인증이 활성화된 경우
- 일반 비밀번호로는 SMTP 접근이 제한됨
- 앱 비밀번호를 사용하면 안전하게 접근 가능

**생성 방법:**
1. Google 계정 설정 접속: https://myaccount.google.com/
2. 보안 → 2단계 인증 (활성화되어 있어야 함)
3. 앱 비밀번호 생성
   - "앱 선택" → "메일"
   - "기기 선택" → "Windows 컴퓨터" 또는 "기타"
4. 생성된 16자리 비밀번호 복사 (예: `abcd efgh ijkl mnop`)

---

## 📝 환경 변수 설정

### `.env` 파일에 추가

```env
# Gmail SMTP 설정
EMAIL_SENDER="your-email@gmail.com"
EMAIL_PASSWORD="abcd efgh ijkl mnop"  # 앱 비밀번호 (공백 제거)
EMAIL_RECEIVER="receiver@example.com"  # 수신 이메일 주소
```

### 중요 사항
- ✅ 앱 비밀번호의 공백은 제거하거나 그대로 사용 가능
- ✅ 일반 비밀번호가 아닌 **앱 비밀번호**를 사용해야 함
- ✅ `.env` 파일은 `.gitignore`에 포함되어 있어야 함

---

## 📨 이메일 형식

### 뉴스 헤드라인 이메일 예시

**제목:**
```
[PsyInsight] 오늘의 심리 뉴스 헤드라인 (2026-01-15)
```

**본문 (HTML):**
```html
<h2>오늘 수집된 뉴스: 15개</h2>

<h3>⭐ 평점 높은 뉴스</h3>
<ul>
  <li>
    <strong>[5점] 뇌과학 연구, 우울증 치료에 새로운 돌파구</strong><br>
    최신 뇌과학 연구가 우울증 치료에 새로운 접근법을 제시했다...<br>
    <a href="https://example.com/news1">원문 보기</a>
  </li>
  <li>
    <strong>[4점] 마음건강 앱, 사용자 만족도 증가</strong><br>
    디지털 헬스케어 앱의 사용자 만족도가 지난해 대비 30% 증가...<br>
    <a href="https://example.com/news2">원문 보기</a>
  </li>
</ul>

<h3>📰 전체 뉴스</h3>
<ul>
  <li>[3점] 심리상담 시장 성장세 지속...</li>
  <li>[4점] 청소년 정신건강 정책 개선...</li>
  ...
</ul>

<p>대시보드에서 전체 내용 확인: <a href="http://your-dashboard-url">접속하기</a></p>
```

### 논문 헤드라인 이메일 예시

**제목:**
```
[PsyInsight] 이번 주 심리학 논문 요약 (2026-01-15)
```

**본문:**
- 수집된 논문 개수
- 각 논문의 제목, 저자, 요약
- 원문 링크

---

## 🛠️ 구현 세부사항

### 이메일 발송 조건
- ✅ 새로 수집된 항목이 있을 때만 발송
- ✅ 수집 실패 시 발송하지 않음
- ✅ 에러 발생 시 로그만 기록

### 발송 시점
- **뉴스**: 매일 수집 완료 후 (새벽 2시)
- **논문**: 매주 수집 완료 후 (월요일 새벽 2시)

### 에러 처리
- SMTP 연결 실패 시 재시도 (최대 3회)
- 발송 실패 시 로그 기록
- 사용자에게는 조용히 실패 (앱은 계속 실행)

---

## 🔒 보안 주의사항

1. **앱 비밀번호 사용**: 일반 비밀번호 절대 사용 금지
2. **환경 변수 관리**: `.env` 파일을 Git에 커밋하지 않음
3. **접근 제한**: 이메일 계정은 프로젝트 전용으로 분리 권장

---

## 📋 테스트 방법

### 수동 테스트
```python
# 테스트 스크립트 실행
python test_email.py
```

### 실제 발송 테스트
1. `.env` 파일에 이메일 정보 입력
2. `collect_news.py` 실행
3. 수신 이메일 확인

---

## ❓ 문제 해결

### "Authentication failed" 에러
- ✅ 앱 비밀번호를 사용하고 있는지 확인
- ✅ 2단계 인증이 활성화되어 있는지 확인
- ✅ 비밀번호에 공백이 포함되어 있는지 확인

### "Connection refused" 에러
- ✅ 방화벽에서 포트 587 허용 확인
- ✅ Gmail SMTP 서버 주소 확인: `smtp.gmail.com`

### 이메일이 스팸으로 분류되는 경우
- ✅ 발신자 이름을 명확하게 설정
- ✅ 이메일 내용에 스팸 키워드 제거
- ✅ 수신자가 발신자를 주소록에 추가

---

**이메일 발송 기능은 완전 자동화의 핵심 기능입니다!**
